# 品質バイパスポリシー

## 🚨 原則

**品質チェックのバイパスは最終手段です。**

## 📋 正当なバイパス理由

### 1. 緊急度「最高」の場合のみ
- ☑️ **セキュリティ脆弱性の緊急修正**
  - CVSSスコア9.0以上
  - 既に攻撃が確認されている
  - ユーザーデータが危険に晒されている

- ☑️ **プロダクション完全停止**
  - サービス全体がダウン
  - 収益に直接影響
  - SLA違反の恐れ

- ☑️ **法的コンプライアンス**
  - 規制当局からの命令
  - 法的期限が迫っている

### 2. 不正当な理由（絶対禁止）
- ❌ 「時間がない」
- ❌ 「テストが面倒」
- ❌ 「後で直す」
- ❌ 「大丈夫だと思う」
- ❌ 「ローカルでは動いた」

## 🔒 バイパス手順

### Step 1: 事前承認
```bash
# バイパス申請を作成
gh issue create \
  --title "Bypass Request: [理由を記載]" \
  --body "$(cat bypass-request-template.md)" \
  --label "bypass-request"
  
# 2名以上の承認が必要
```

### Step 2: 記録付きバイパス
```bash
# 理由を記録してバイパス
BYPASS_REASON="security-CVE-2024-xxxxx" \
BYPASS_TICKET="ISSUE-123" \
git commit --no-verify -m "fix: [BYPASS] 緊急セキュリティ修正

BYPASS_REASON: $BYPASS_REASON
BYPASS_TICKET: $BYPASS_TICKET
BYPASS_APPROVERS: @user1, @user2"
```

### Step 3: 事後対応
```bash
# 24時間以内に以下を実施
1. テストを追加
2. 適切なコードレビュー
3. 監査ログの更新
4. レトロスペクティブの実施
```

## 📊 バイパス制限

### 個人制限
- 月間上限: **3回**
- 四半期上限: **5回**
- 年間上限: **10回**

### チーム制限
- 月間上限: **5回**
- 四半期上限: **10回**

### 超過時の対応
1. 1回超過: 警告 + 改善計画書提出
2. 2回超過: バイパス権限一時停止（1週間）
3. 3回超過: コードレビュー必須化（1ヶ月）

## 🎯 バイパス削減目標

### 2024年Q1
- 現状: 月平均15回
- 目標: 月平均10回以下

### 2024年Q2
- 目標: 月平均5回以下

### 2024年Q3
- 目標: 月平均3回以下

### 2024年Q4
- 目標: 月平均1回以下

## 🏆 インセンティブ

### バイパスゼロ達成
- **個人**: 月間バイパスゼロ → 表彰
- **チーム**: 四半期バイパスゼロ → ボーナスポイント

### 改善提案
- バイパス原因の根本解決策を提案 → 貢献ポイント
- 自動化による品質向上 → 特別表彰

## 📈 監査とレポート

### 週次レポート
```yaml
# 毎週月曜日に自動生成
- バイパス回数
- 理由の内訳
- ユーザー別統計
```

### 月次レビュー
```yaml
# 月初にチーム全体でレビュー
- トレンド分析
- 根本原因分析
- 改善アクション決定
```

### 四半期評価
```yaml
# 四半期ごとに経営層へ報告
- KPI達成状況
- 品質メトリクス
- 次四半期の目標設定
```

## 🚫 ペナルティ

### Level 1: 警告
- 月間制限の50%到達時

### Level 2: 制限
- 月間制限超過時
- バイパス権限の一時停止

### Level 3: エスカレーション
- 繰り返し違反
- 管理者への報告
- パフォーマンス評価への影響

## ✅ 代替手段

### バイパスの代わりに
1. **Feature Flag使用**
   - 段階的リリース
   - リスク最小化

2. **Canaryデプロイ**
   - 小規模テスト
   - 段階的展開

3. **Hotfixブランチ**
   - 専用フロー
   - 事後テスト保証

4. **ペアプログラミング**
   - リアルタイムレビュー
   - 品質担保

## 📝 テンプレート

### バイパス申請テンプレート
```markdown
## バイパス申請

### 理由
- [ ] セキュリティ脆弱性
- [ ] プロダクション障害
- [ ] 法的要件

### 詳細
[具体的な状況を記載]

### 影響範囲
[影響を受けるシステム/ユーザー]

### 代替手段の検討
[なぜバイパスが必要か]

### 事後対応計画
[24時間以内の対応]

### 承認者
- [ ] @approver1
- [ ] @approver2
```

---

**Remember**: Every bypass is a debt. Pay it back quickly.